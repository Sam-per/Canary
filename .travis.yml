language: python

sudo: required
dist: xenial

python:
 - "3.6"

services:
  - docker

before_install:
 - sed -i "s/KEY/$DISCORD_TOKEN/g" config/config.ini

jobs:
  include:
   - stage: Build
     script: docker build -t canary:latest .
   - stage: Test
     script: docker run -v $(pwd):/mnt/canary canary:latest "bash ./test.sh"
   - stage: Lint
     script: docker run -v $(pwd):/mnt/canary canary:latest "poetry run yapf --diff --recursive ."

notifications:
 email: false
